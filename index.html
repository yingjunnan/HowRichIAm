<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘æœ‰å¤šå¯Œ-ç‰›é©¬æ”¶å…¥è®¡ç®—å™¨ ğŸ’°</title>
    <script src="assets/js/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow-x: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark-glass {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(15px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .dark-glass-dynamic {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(var(--blur-amount, 15px)) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        .light-glass-dynamic {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(var(--blur-amount, 15px)) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.15);
        }

        .light-glass-dynamic .text-white {
            color: #1f2937 !important;
        }

        .light-glass-dynamic .opacity-80 {
            opacity: 0.8 !important;
        }

        .light-glass-dynamic .opacity-60 {
            opacity: 0.6 !important;
        }
        
        .income-display {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .income-number {
            font-variant-numeric: tabular-nums;
            letter-spacing: -0.02em;
        }
        
        .settings-panel {
            transition: transform 0.3s ease-in-out;
            transform: translateX(100%);
        }
        
        .settings-panel.show {
            transform: translateX(0);
        }
        
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            pointer-events: none;
            white-space: nowrap;
            max-width: 300px;
            white-space: normal;
        }
        
        .income-animation {
            animation: incomeGlow 0.5s ease-out;
        }
        
        @keyframes incomeGlow {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .progress-bar {
            transition: width 0.5s ease-out;
        }
        
        .question-mark {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            font-size: 12px;
            margin-left: 8px;
            cursor: help;
        }
        
        .break-time-indicator {
            animation: blink 1.5s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- èƒŒæ™¯å±‚ -->
        <div class="fixed inset-0 -z-10">
            <!-- å£çº¸å±‚ -->
            <div v-if="settings.wallpaperUrl" class="absolute inset-0">
                <img :src="settings.wallpaperUrl"
                     class="w-full h-full object-cover"
                     :style="{ filter: `blur(${settings.wallpaperBlur}px)` }">
            </div>
            <!-- ä¸»é¢˜è‰²å±‚ -->
            <div v-else class="absolute inset-0" :style="{ background: settings.themeColor }"></div>
            <!-- ä¸»é¢˜è‰²è¦†ç›–å±‚ (å½“åˆ‡æ¢ä¸»é¢˜æ—¶è¦†ç›–å£çº¸) -->
            <div v-if="settings.wallpaperUrl && showThemeOverlay"
                 class="absolute inset-0 transition-opacity duration-500"
                 :style="{ background: settings.themeColor, opacity: themeOverlayOpacity }"></div>
        </div>

        <!-- è®¾ç½®é¢æ¿é®ç½© -->
        <div v-if="showSettings" 
             @click="toggleSettings"
             class="fixed inset-0 bg-black bg-opacity-50 z-40 transition-opacity"></div>

        <!-- ä¸»å®¹å™¨ -->
        <div class="min-h-screen flex flex-col relative" :style="`--blur-amount: ${5 + settings.pageOpacity * 0.2}px`">
            
            <!-- é¡¶éƒ¨æ  -->
            <header class="p-4 flex justify-between items-center relative">
                <div class="flex gap-2">
                    <button @click.stop="toggleSettings"
                            :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'hover:bg-white', 'hover:bg-opacity-20', 'transition']">
                        <i class="fas fa-cog mr-2"></i>è®¾ç½®
                    </button>
                    <!-- å ä½æŒ‰é’®ï¼Œç”¨äºå¹³è¡¡å³ä¾§æŒ‰é’®æ•°é‡ -->
                    <div class="invisible">
                        <button class="glass-effect dark-glass px-4 py-2 rounded-lg text-white">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <div :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'text-lg', 'text-center', 'absolute', 'left-1/2', 'transform', '-translate-x-1/2']">
                    <i class="fas fa-clock mr-6"></i>{{ formattedDateTime }}
                </div>
                <div class="flex gap-2">
                    <button @click="toggleHideIncome" title="æ˜¾ç¤º/éšè—æ”¶å…¥"
                            :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'hover:bg-white', 'hover:bg-opacity-20', 'transition']">
                        <i :class="hideIncome ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                    </button>
                    <button @click="loadRandomWallpaper" title="éšæœºå£çº¸"
                            :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'hover:bg-white', 'hover:bg-opacity-20', 'transition']">
                        <i class="fas fa-image"></i>
                    </button>
                    <button @click="toggleFullscreen" title="åˆ‡æ¢å…¨å±"
                            :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'hover:bg-white', 'hover:bg-opacity-20', 'transition']">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button @click="changeTheme" title="åˆ‡æ¢ä¸»é¢˜"
                            :class="['glass-effect', glassClass, 'px-4', 'py-2', 'rounded-lg', 'text-white', 'hover:bg-white', 'hover:bg-opacity-20', 'transition']">
                        <i class="fas fa-palette"></i>
                    </button>
                </div>
            </header>

            <!-- æœç´¢æ¡†åŒºåŸŸ -->
            <div class="px-4 pb-4">
                <div :class="['glass-effect', glassClass, 'rounded-lg', 'p-4', 'max-w-3xl', 'mx-auto']">
                    <form @submit.prevent="performSearch" class="flex gap-2">
                        <select v-model="selectedSearchEngine" 
                                class="bg-gray-800 text-white rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="baidu">ç™¾åº¦</option>
                            <option value="bing">Bing</option>
                            <option value="google">Google</option>
                        </select>
                        <input type="text" 
                               v-model="searchQuery"
                               placeholder="è¾“å…¥æœç´¢å†…å®¹..."
                               class="flex-1 bg-gray-800 text-white rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button type="submit" 
                                class="bg-blue-600 hover:bg-blue-700 text-white rounded px-4 py-2 transition">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>
            </div>

            <!-- ä¸»å†…å®¹åŒº -->
            <main class="flex-1 flex items-center justify-center p-8">
                <div class="text-center max-w-4xl mx-auto">
                    
                    <!-- å®æ—¶æ”¶å…¥æ˜¾ç¤º -->
                    <div class="income-display mb-8 relative">
                        <h2 class="text-white text-2xl mb-4 opacity-80 flex items-center justify-center">
                            ä»Šæ—¥å·²èµš
                            <span class="question-mark"
                                  @mouseenter="showTooltip($event)"
                                  @mouseleave="hideTooltip"
                                  ref="questionMark">?</span>
                        </h2>
                        <div class="income-animation">
                            <div class="text-6xl md:text-8xl font-bold text-white mb-2 income-number">
                                <span v-if="!hideIncome">Â¥{{ formatNumber(currentDayIncome) }}</span>
                                <span v-else class="text-4xl">****</span>
                            </div>
                            <div class="text-white text-3xl md:text-4xl opacity-60 income-number">
                                <span v-if="!hideIncome && !isOnBreak">+{{ formatNumber(perSecondIncome) }}/ç§’</span>
                                <span v-else-if="hideIncome">****</span>
                                <span v-else class="break-time-indicator">
                                    <i class="fas fa-coffee mr-2"></i>åˆä¼‘æ—¶é—´
                                </span>
                            </div>
                        </div>

                        <!-- æ—¥è–ªæ˜¾ç¤º -->
                        <div :class="['glass-effect', glassClass, 'rounded-lg', 'px-4', 'py-2', 'mt-4', 'inline-block']">
                            <span class="text-white opacity-80">æ—¥è–ª: </span>
                            <span class="text-white text-xl font-bold income-number">
                                <span v-if="!hideIncome">Â¥{{ formatNumber(dailyIncome) }}</span>
                                <span v-else>****</span>
                            </span>
                        </div>
                    </div>

                    <!-- å·¥ä½œè¿›åº¦ -->
                    <div :class="['glass-effect', glassClass, 'rounded-xl', 'p-6', 'mb-6']">
                        <div class="flex justify-between text-white mb-2">
                            <span>ä»Šæ—¥å·¥ä½œè¿›åº¦</span>
                            <span>{{ Math.round(workProgress) }}%</span>
                        </div>
                        <div class="w-full bg-gray-700 rounded-full h-4 overflow-hidden">
                            <div class="progress-bar bg-gradient-to-r from-green-400 to-blue-500 h-full rounded-full"
                                 :style="{ width: `${workProgress}%` }"></div>
                        </div>
                        <div class="text-white mt-4 text-center">
                            <span v-if="isWorkingTime && !isOnBreak" class="text-xl">
                                <i class="fas fa-clock mr-2"></i>
                                è·ç¦»ä¸‹ç­è¿˜æœ‰ {{ countdownToWorkEnd }}
                            </span>
                            <span v-else-if="isOnBreak" class="text-xl break-time-indicator">
                                <i class="fas fa-utensils mr-2"></i>
                                ç°åœ¨æ˜¯åˆä¼‘æ—¶é—´ï¼Œè·ç¦»ä¸Šç­è¿˜æœ‰ {{ countdownToBreakEnd }}
                            </span>
                            <span v-else-if="isBeforeWork" class="text-xl">
                                <i class="fas fa-bed mr-2"></i>
                                è·ç¦»ä¸Šç­è¿˜æœ‰ {{ countdownToWorkStart }}
                            </span>
                            <span v-else class="text-xl">
                                <i class="fas fa-check-circle mr-2"></i>
                                ä»Šæ—¥å·¥ä½œå·²å®Œæˆï¼
                            </span>
                        </div>
                    </div>

                    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div :class="['glass-effect', glassClass, 'rounded-xl', 'p-4']">
                            <div class="text-white opacity-80 mb-1">æ¯å°æ—¶æ”¶å…¥</div>
                            <div class="text-2xl font-bold text-white income-number">
                                <span v-if="!hideIncome">Â¥{{ formatNumber(perHourIncome) }}</span>
                                <span v-else>****</span>
                            </div>
                        </div>
                        <div :class="['glass-effect', glassClass, 'rounded-xl', 'p-4']">
                            <div class="text-white opacity-80 mb-1">æ¯åˆ†é’Ÿæ”¶å…¥</div>
                            <div class="text-2xl font-bold text-white income-number">
                                <span v-if="!hideIncome">Â¥{{ formatNumber(perMinuteIncome) }}</span>
                                <span v-else>****</span>
                            </div>
                        </div>
                        <div :class="['glass-effect', glassClass, 'rounded-xl', 'p-4']">
                            <div class="text-white opacity-80 mb-1">æœ¬æœˆé¢„è®¡æ”¶å…¥</div>
                            <div class="text-2xl font-bold text-white income-number">
                                <span v-if="!hideIncome">Â¥{{ formatNumber(monthlyEstimatedIncome) }}</span>
                                <span v-else>****</span>
                            </div>
                        </div>
                    </div>

                    <!-- å¿«é€Ÿç»Ÿè®¡ -->
                    <div :class="['glass-effect', glassClass, 'rounded-xl', 'p-4']">
                        <div class="flex justify-around text-white">
                            <div class="text-center">
                                <div class="opacity-60 text-sm">æœ¬æœˆå·²å·¥ä½œ</div>
                                <div class="text-xl font-bold">{{ workedDaysThisMonth }} å¤©</div>
                            </div>
                            <div class="text-center">
                                <div class="opacity-60 text-sm">æœ¬æœˆå·²èµš</div>
                                <div class="text-xl font-bold">
                                    <span v-if="!hideIncome">Â¥{{ formatNumber(currentMonthIncome) }}</span>
                                    <span v-else>****</span>
                                </div>
                            </div>
                            <div class="text-center">
                                <div class="opacity-60 text-sm">è·ç¦»ç›®æ ‡</div>
                                <div class="text-xl font-bold">
                                    <span v-if="!hideIncome">Â¥{{ formatNumber(remainingToTarget) }}</span>
                                    <span v-else>****</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- è®¾ç½®é¢æ¿ -->
            <aside class="fixed right-0 top-0 h-full w-80 bg-gray-900 text-white settings-panel overflow-y-auto z-50"
                  :class="{ show: showSettings }">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">è®¾ç½®</h3>
                        <button @click="toggleSettings" class="text-gray-400 hover:text-white">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- æ”¶å…¥è®¾ç½® -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">æ”¶å…¥é…ç½®</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm opacity-80 mb-1">æœˆè–ª (å…ƒ)</label>
                                <input type="number" v-model.number="config.monthlySalary" 
                                       class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">æ¯å‘¨å·¥ä½œå¤©æ•°</label>
                                <input type="range" min="1" max="7" v-model.number="config.workDaysPerWeek" 
                                       class="w-full">
                                <div class="text-center text-sm opacity-60">{{ config.workDaysPerWeek }} å¤©</div>
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">æ¯å¤©å·¥ä½œæ—¶é•¿ (å°æ—¶)</label>
                                <input type="number" v-model.number="config.dailyWorkHours" 
                                       class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                        </div>
                    </div>

                    <!-- å·¥ä½œæ—¶é—´è®¾ç½® -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">å·¥ä½œæ—¶é—´</h4>
                        <div class="space-y-4">
                            <div class="flex gap-2">
                                <div class="flex-1">
                                    <label class="block text-sm opacity-80 mb-1">ä¸Šç­æ—¶é—´</label>
                                    <input type="time" v-model="config.workStartTime" 
                                           class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                                <div class="flex-1">
                                    <label class="block text-sm opacity-80 mb-1">ä¸‹ç­æ—¶é—´</label>
                                    <input type="time" v-model="config.workEndTime" 
                                           class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">åˆä¼‘æ—¶é—´</label>
                                <div class="flex gap-2">
                                    <div class="flex-1">
                                        <input type="time" v-model="config.lunchStartTime" 
                                               class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                    <div class="flex items-center px-2">è‡³</div>
                                    <div class="flex-1">
                                        <input type="time" v-model="config.lunchEndTime" 
                                               class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- åˆ·æ–°è®¾ç½® -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">åˆ·æ–°è®¾ç½®</h4>
                        <div>
                            <label class="block text-sm opacity-80 mb-1">æ•°æ®åˆ·æ–°é¢‘ç‡</label>
                            <select v-model="config.refreshInterval"
                                    @change="restartTimer"
                                    class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="1000">æ¯1ç§’</option>
                                <option value="2000">æ¯2ç§’</option>
                                <option value="5000">æ¯5ç§’</option>
                            </select>
                        </div>
                    </div>

                    <!-- è®¡ç®—æ–¹å¼ -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">è®¡ç®—æ–¹å¼</h4>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" v-model="config.useActualMonthDays" 
                                   class="w-4 h-4 text-blue-600 bg-gray-800 rounded focus:ring-blue-500">
                            <span>æŒ‰å®é™…è‡ªç„¶æœˆå¤©æ•°è®¡ç®—</span>
                        </label>
                    </div>

                    <!-- ä¸»é¢˜è®¾ç½® -->
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3">ä¸»é¢˜è®¾ç½®</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm opacity-80 mb-1">ä¸»é¢˜é¢œè‰²</label>
                                <input type="color" v-model="settings.themeColor" 
                                       class="w-full h-10 bg-gray-800 rounded cursor-pointer">
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">æ¯›ç»ç’ƒæ¨¡ç³Šåº¦</label>
                                <input type="range" min="0" max="100" v-model.number="settings.pageOpacity"
                                       class="w-full">
                                <div class="text-center text-sm opacity-60">{{ settings.pageOpacity }}% ({{ (5 + settings.pageOpacity * 0.2).toFixed(1) }}px)</div>
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">æ¯›ç»ç’ƒé¢œè‰²</label>
                                <div class="flex gap-4">
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="radio" value="dark" v-model="settings.glassTheme"
                                               class="w-4 h-4 text-blue-600 bg-gray-800">
                                        <span>é»‘è‰²</span>
                                    </label>
                                    <label class="flex items-center gap-2 cursor-pointer">
                                        <input type="radio" value="light" v-model="settings.glassTheme"
                                               class="w-4 h-4 text-blue-600 bg-gray-800">
                                        <span>ç™½è‰²</span>
                                    </label>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm opacity-80 mb-1">å£çº¸è®¾ç½®</label>
                                <div class="space-y-2">
                                    <button style="display:none" @click="loadRandomWallpaper" 
                                            class="w-full bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded transition">
                                        <i class="fas fa-image mr-2"></i>éšæœºå£çº¸
                                    </button>
                                    <input type="text" v-model="settings.wallpaperUrl" 
                                           placeholder="æˆ–è¾“å…¥å£çº¸URL"
                                           class="w-full bg-gray-800 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <div v-if="settings.wallpaperUrl">
                                        <label class="block text-sm opacity-80 mb-1">æ¨¡ç³Šåº¦</label>
                                        <input type="range" min="0" max="20" v-model.number="settings.wallpaperBlur" 
                                               class="w-full">
                                        <div class="text-center text-sm opacity-60">{{ settings.wallpaperBlur }}px</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- æ•°æ®é‡ç½® -->
                    <div class="pt-4 border-t border-gray-700">
                        <button @click="resetConfig" 
                                class="w-full bg-red-600 hover:bg-red-700 px-4 py-2 rounded transition">
                            <i class="fas fa-redo mr-2"></i>é‡ç½®æ‰€æœ‰è®¾ç½®
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Tooltip -->
            <div v-if="showTooltipContent" class="tooltip" :style="tooltipStyle">
                <div class="font-semibold mb-2">è®¡ç®—å…¬å¼ï¼š</div>
                <div class="text-sm space-y-1">
                    <div>å·²å·¥ä½œæ—¶é•¿: {{ workedMinutesToday.toFixed(1) }} åˆ†é’Ÿ</div>
                    <div>æ—¶è–ª: Â¥{{ formatNumber(hourlyIncome) }}</div>
                    <div>ä»Šæ—¥æ”¶å…¥: {{ workedMinutesToday.toFixed(1) }} Ã· 60 Ã— Â¥{{ formatNumber(hourlyIncome) }}</div>
                    <div>= Â¥{{ formatNumber(currentDayIncome) }}</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    showSettings: false,
                    currentTime: new Date(),
                    showTooltipContent: false,
                    tooltipStyle: { top: '0px', left: '0px' },
                    updateTimer: null,
                    isFirstVisit: true,
                    hideIncome: false,
                    selectedSearchEngine: 'bing',
                    searchQuery: '',
                    showThemeOverlay: false,
                    themeOverlayOpacity: 0,
                    config: {
                        monthlySalary: 15000,
                        workDaysPerWeek: 5,
                        dailyWorkHours: 8,
                        workStartTime: '09:00',
                        workEndTime: '18:00',
                        lunchStartTime: '12:00',
                        lunchEndTime: '13:00',
                        refreshInterval: 1000,
                        useActualMonthDays: false
                    },
                    settings: {
                        themeColor: '#059669',
                        pageOpacity: 0.8,
                        wallpaperUrl: '',
                        wallpaperBlur: 5,
                        glassTheme: 'dark'
                    }
                }
            },
            computed: {
                glassClass() {
                    return this.settings.glassTheme === 'light' ? 'light-glass-dynamic' : 'dark-glass-dynamic';
                },
                workHoursPerDay() {
                    const [lunchStartHour, lunchStartMin] = this.config.lunchStartTime.split(':').map(Number);
                    const [lunchEndHour, lunchEndMin] = this.config.lunchEndTime.split(':').map(Number);
                    const lunchMinutes = (lunchEndHour * 60 + lunchEndMin) - (lunchStartHour * 60 + lunchStartMin);
                    return this.config.dailyWorkHours - (lunchMinutes / 60);
                },
                workDaysPerMonth() {
                    if (this.config.useActualMonthDays) {
                        const year = this.currentTime.getFullYear();
                        const month = this.currentTime.getMonth();
                        const firstDay = new Date(year, month, 1);
                        const lastDay = new Date(year, month + 1, 0);
                        let workDays = 0;
                        
                        for (let day = 1; day <= lastDay.getDate(); day++) {
                            const date = new Date(year, month, day);
                            const dayOfWeek = date.getDay();
                            if (dayOfWeek !== 0 && dayOfWeek !== 6) { // æ’é™¤å‘¨æœ«
                                workDays++;
                            }
                        }
                        return workDays;
                    }
                    return Math.floor(30.42 * this.config.workDaysPerWeek / 7);
                },
                dailyIncome() {
                    return this.config.monthlySalary / this.workDaysPerMonth;
                },
                hourlyIncome() {
                    return this.dailyIncome / this.workHoursPerDay;
                },
                perSecondIncome() {
                    return this.hourlyIncome / 3600;
                },
                perMinuteIncome() {
                    return this.hourlyIncome / 60;
                },
                perHourIncome() {
                    return this.hourlyIncome;
                },
                isOnBreak() {
                    const now = this.currentTime;
                    const currentMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
                    const [lunchStartHour, lunchStartMin] = this.config.lunchStartTime.split(':').map(Number);
                    const [lunchEndHour, lunchEndMin] = this.config.lunchEndTime.split(':').map(Number);
                    const lunchStartMinutes = lunchStartHour * 60 + lunchStartMin;
                    const lunchEndMinutes = lunchEndHour * 60 + lunchEndMin;
                    
                    const dayOfWeek = now.getDay();
                    if (dayOfWeek === 0 || dayOfWeek === 6) return false;
                    
                    return currentMinutes >= lunchStartMinutes && currentMinutes < lunchEndMinutes;
                },
                isWorkingTime() {
                    if (this.isOnBreak) return false;
                    
                    const now = this.currentTime;
                    const [workStartHour, workStartMin] = this.config.workStartTime.split(':').map(Number);
                    const [workEndHour, workEndMin] = this.config.workEndTime.split(':').map(Number);
                    
                    // åŒ…å«ç§’æ•°ï¼Œç¡®ä¿æ¯ç§’éƒ½èƒ½æ›´æ–°è®¡ç®—ç»“æœ
                    const currentMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
                    const workStartMinutes = workStartHour * 60 + workStartMin;
                    const workEndMinutes = workEndHour * 60 + workEndMin;
                    
                    const dayOfWeek = now.getDay();
                    if (dayOfWeek === 0 || dayOfWeek === 6) return false;
                    
                    return currentMinutes >= workStartMinutes && currentMinutes < workEndMinutes;
                },
                isBeforeWork() {
                    const now = this.currentTime;
                    const [workStartHour, workStartMin] = this.config.workStartTime.split(':').map(Number);
                    const currentMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
                    const workStartMinutes = workStartHour * 60 + workStartMin;
                    
                    const dayOfWeek = now.getDay();
                    if (dayOfWeek === 0 || dayOfWeek === 6) return false;
                    
                    return currentMinutes < workStartMinutes;
                },
                workedMinutesToday() {
                    if (!this.isWorkingTime && !this.isBeforeWork) {
                        return this.workHoursPerDay * 60;
                    }
                    if (!this.isWorkingTime && this.isBeforeWork) {
                        return 0;
                    }
                    
                    const now = this.currentTime;
                    const [workStartHour, workStartMin] = this.config.workStartTime.split(':').map(Number);
                    const [lunchStartHour, lunchStartMin] = this.config.lunchStartTime.split(':').map(Number);
                    const [lunchEndHour, lunchEndMin] = this.config.lunchEndTime.split(':').map(Number);
                    
                    // åŒ…å«ç§’æ•°ï¼Œç¡®ä¿æ¯ç§’éƒ½èƒ½æ›´æ–°è®¡ç®—ç»“æœ
                    const currentMinutes = now.getHours() * 60 + now.getMinutes() + now.getSeconds() / 60;
                    const workStartMinutes = workStartHour * 60 + workStartMin;
                    const lunchStartMinutes = lunchStartHour * 60 + lunchStartMin;
                    const lunchEndMinutes = lunchEndHour * 60 + lunchEndMin;
                    
                    let workedMinutes = 0;
                    if (currentMinutes <= lunchStartMinutes) {
                        workedMinutes = currentMinutes - workStartMinutes;
                    } else {
                        workedMinutes = (lunchStartMinutes - workStartMinutes) + (currentMinutes - lunchEndMinutes);
                    }
                    
                    return workedMinutes;
                },
                workProgress() {
                    const totalWorkMinutes = this.workHoursPerDay * 60;
                    return Math.min((this.workedMinutesToday / totalWorkMinutes) * 100, 100);
                },
                currentDayIncome() {
                    // å¦‚æœæ˜¯ä¸Šç­å‰
                    if (!this.isWorkingTime && this.isBeforeWork) {
                        return 0;
                    }

                    // å¦‚æœæ˜¯åˆä¼‘æ—¶é—´ï¼Œæ˜¾ç¤ºåˆ°åˆä¼‘å¼€å§‹æ—¶çš„ç´¯è®¡æ”¶å…¥
                    if (this.isOnBreak) {
                        const [workStartHour, workStartMin] = this.config.workStartTime.split(':').map(Number);
                        const [lunchStartHour, lunchStartMin] = this.config.lunchStartTime.split(':').map(Number);

                        const workStartMinutes = workStartHour * 60 + workStartMin;
                        const lunchStartMinutes = lunchStartHour * 60 + lunchStartMin;

                        // ä¸Šåˆå·¥ä½œæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
                        const morningWorkMinutes = lunchStartMinutes - workStartMinutes;

                        return (morningWorkMinutes / 60) * this.hourlyIncome;
                    }

                    // å¦‚æœæ˜¯å·¥ä½œæ—¥å·²å®Œæˆï¼ˆä¸‹ç­åï¼‰
                    if (!this.isWorkingTime && !this.isBeforeWork) {
                        return this.hourlyIncome * this.workHoursPerDay;
                    }

                    // æ­£å¸¸å·¥ä½œæ—¶é—´ï¼Œæ˜¾ç¤ºå½“å‰ç´¯è®¡æ”¶å…¥
                    const workedHours = this.workedMinutesToday / 60;
                    return workedHours * this.hourlyIncome;
                },
                countdownToWorkEnd() {
                    const [workEndHour, workEndMin] = this.config.workEndTime.split(':').map(Number);
                    const endTime = new Date();
                    endTime.setHours(workEndHour, workEndMin, 0, 0);
                    
                    const diff = endTime - this.currentTime;
                    if (diff <= 0) return 'å·²ä¸‹ç­';
                    
                    const hours = Math.floor(diff / 3600000);
                    const minutes = Math.floor((diff % 3600000) / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    
                    return `${hours}æ—¶${minutes}åˆ†${seconds}ç§’`;
                },
                countdownToBreakEnd() {
                    const [lunchEndHour, lunchEndMin] = this.config.lunchEndTime.split(':').map(Number);
                    const endTime = new Date();
                    endTime.setHours(lunchEndHour, lunchEndMin, 0, 0);
                    
                    const diff = endTime - this.currentTime;
                    if (diff <= 0) return 'åˆä¼‘ç»“æŸ';
                    
                    const hours = Math.floor(diff / 3600000);
                    const minutes = Math.floor((diff % 3600000) / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    
                    return `${hours}æ—¶${minutes}åˆ†${seconds}ç§’`;
                },
                countdownToWorkStart() {
                    const [workStartHour, workStartMin] = this.config.workStartTime.split(':').map(Number);
                    const startTime = new Date();
                    startTime.setHours(workStartHour, workStartMin, 0, 0);
                    
                    const diff = startTime - this.currentTime;
                    if (diff <= 0) return 'å·²ä¸Šç­';
                    
                    const hours = Math.floor(diff / 3600000);
                    const minutes = Math.floor((diff % 3600000) / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    
                    return `${hours}æ—¶${minutes}åˆ†${seconds}ç§’`;
                },
                monthlyEstimatedIncome() {
                    return this.config.monthlySalary;
                },
                workedDaysThisMonth() {
                    const now = this.currentTime;
                    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                    let workDays = 0;
                    
                    for (let d = startOfMonth; d <= now; d.setDate(d.getDate() + 1)) {
                        const dayOfWeek = d.getDay();
                        if (dayOfWeek !== 0 && dayOfWeek !== 6) {
                            workDays++;
                        }
                    }
                    
                    return workDays;
                },
                currentMonthIncome() {
                    return this.workedDaysThisMonth * this.workHoursPerDay * this.hourlyIncome;
                },
                remainingToTarget() {
                    return Math.max(0, this.config.monthlySalary - this.currentMonthIncome);
                },
                formattedDateTime() {
                    const now = this.currentTime;
                    const year = now.getFullYear();
                    const month = String(now.getMonth() + 1).padStart(2, '0');
                    const day = String(now.getDate()).padStart(2, '0');
                    const hours = String(now.getHours()).padStart(2, '0');
                    const minutes = String(now.getMinutes()).padStart(2, '0');
                    const seconds = String(now.getSeconds()).padStart(2, '0');

                    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
                }
            },
            methods: {
                formatNumber(num) {
                    return new Intl.NumberFormat('zh-CN', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    }).format(num);
                },
                toggleHideIncome() {
                    this.hideIncome = !this.hideIncome;
                    this.saveToLocal();
                },
                toggleSettings() {
                    this.showSettings = !this.showSettings;
                    // å¦‚æœæ˜¯é¦–æ¬¡è®¿é—®ï¼Œå…³é—­æç¤º
                    if (this.isFirstVisit) {
                        this.isFirstVisit = false;
                        this.saveToLocal();
                    }
                },
                showFirstVisitTip() {
                    // æ£€æŸ¥æ˜¯å¦æ˜¯é¦–æ¬¡è®¿é—®
                    if (this.isFirstVisit) {
                        // å»¶è¿Ÿä¸€ç‚¹æ—¶é—´æ˜¾ç¤ºæç¤ºï¼Œè®©é¡µé¢å…ˆåŠ è½½å®Œæˆ
                        setTimeout(() => {
                            alert('æ¬¢è¿ä½¿ç”¨æ‰“å·¥äººæ”¶å…¥è®¡ç®—å™¨ï¼\nè¯·åœ¨å·¦ä¸Šè§’"è®¾ç½®"ä¸­æ›´æ–°æ‚¨çš„æ”¶å…¥ä¿¡æ¯ï¼Œä»¥ä¾¿è·å¾—å‡†ç¡®çš„è®¡ç®—ç»“æœã€‚');
                        }, 1000);
                    }
                },
                toggleFullscreen() {
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen();
                    } else {
                        document.exitFullscreen();
                    }
                },
                changeTheme() {
                    const themes = [
                        '#1e40af', // è“è‰²
                        '#dc2626', // çº¢è‰²
                        '#059669', // ç»¿è‰²
                        '#7c3aed', // ç´«è‰²
                        '#ea580c', // æ©™è‰²
                        '#0891b2'  // é’è‰²
                    ];
                    const currentIndex = themes.indexOf(this.settings.themeColor);
                    const nextIndex = (currentIndex + 1) % themes.length;
                    this.settings.themeColor = themes[nextIndex];

                    // å¦‚æœæœ‰å£çº¸ï¼Œæ˜¾ç¤ºä¸»é¢˜è¦†ç›–å±‚
                    if (this.settings.wallpaperUrl) {
                        this.showThemeOverlay = true;
                        this.themeOverlayOpacity = 0.8; // è®¾ç½®é€æ˜åº¦ï¼Œè®©ä¸»é¢˜è‰²èƒ½è¦†ç›–å£çº¸
                    }
                },
                loadRandomWallpaper() {
                    const wallpapers = [];
                    // ç”Ÿæˆwork1åˆ°work30çš„å£çº¸æ•°ç»„
                    for (let i = 1; i <= 30; i++) {
                        wallpapers.push(`https://picsum.photos/seed/work${i}/1920/1080.jpg`);
                    }
                    const randomIndex = Math.floor(Math.random() * wallpapers.length);
                    this.settings.wallpaperUrl = wallpapers[randomIndex];
                    // åŠ è½½æ–°å£çº¸æ—¶æ¸…é™¤ä¸»é¢˜è¦†ç›–å±‚
                    this.showThemeOverlay = false;
                },
                resetConfig() {
                    if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿ')) {
                        const oldInterval = this.config.refreshInterval;
                        this.config = {
                            monthlySalary: 15000,
                            workDaysPerWeek: 5,
                            dailyWorkHours: 8,
                            workStartTime: '09:00',
                            workEndTime: '18:00',
                            lunchStartTime: '12:00',
                            lunchEndTime: '13:00',
                            refreshInterval: oldInterval, // ä¿æŒç”¨æˆ·å½“å‰çš„åˆ·æ–°é¢‘ç‡è®¾ç½®
                            useActualMonthDays: true
                        };
                        this.settings = {
                            themeColor: '#1e40af',
                            pageOpacity: 0.8,
                            wallpaperUrl: '',
                            wallpaperBlur: 5,
                            glassTheme: 'dark'
                        };
                        this.restartTimer();
                    }
                },
                updateTime() {
                    // åœ¨Vue 3ä¸­ç›´æ¥èµ‹å€¼å³å¯è§¦å‘å“åº”å¼æ›´æ–°
                    this.currentTime = new Date();
                },
                restartTimer() {
                    if (this.updateTimer) {
                        clearInterval(this.updateTimer);
                    }
                    // ä½¿ç”¨ç®­å¤´å‡½æ•°ç¡®ä¿thisæŒ‡å‘æ­£ç¡®çš„Vueå®ä¾‹
                    const interval = parseInt(this.config.refreshInterval);
                    console.log('è®¾ç½®åˆ·æ–°é—´éš”ä¸º:', interval + 'ms'); // è°ƒè¯•æ—¥å¿—
                    this.updateTimer = setInterval(() => this.updateTime(), interval);
                },
                showTooltip(event) {
                    const rect = event.target.getBoundingClientRect();
                    this.tooltipStyle = {
                        top: `${rect.bottom + 10}px`,
                        left: `${rect.left - 150}px`
                    };
                    this.showTooltipContent = true;
                },
                hideTooltip() {
                    this.showTooltipContent = false;
                },
                saveToLocal() {
                    localStorage.setItem('incomeConfig', JSON.stringify(this.config));
                    localStorage.setItem('incomeSettings', JSON.stringify(this.settings));
                    localStorage.setItem('isFirstVisit', JSON.stringify(this.isFirstVisit));
                    localStorage.setItem('hideIncome', JSON.stringify(this.hideIncome));
                },
                loadFromLocal() {
                    const savedConfig = localStorage.getItem('incomeConfig');
                    const savedIsFirstVisit = localStorage.getItem('isFirstVisit');
                    const savedSettings = localStorage.getItem('incomeSettings');
                    const savedHideIncome = localStorage.getItem('hideIncome');

                    if (savedConfig) {
                        this.config = JSON.parse(savedConfig);
                    }
                    if (savedSettings) {
                        this.settings = JSON.parse(savedSettings);
                    }
                    if (savedIsFirstVisit !== null) {
                        this.isFirstVisit = JSON.parse(savedIsFirstVisit);
                    }
                    if (savedHideIncome !== null) {
                        this.hideIncome = JSON.parse(savedHideIncome);
                    }
                },
                performSearch() {
                    if (!this.searchQuery.trim()) return;

                    let searchUrl = '';
                    const encodedQuery = encodeURIComponent(this.searchQuery);

                    switch(this.selectedSearchEngine) {
                        case 'baidu':
                            searchUrl = `https://www.baidu.com/s?wd=${encodedQuery}`;
                            break;
                        case 'bing':
                            searchUrl = `https://www.bing.com/search?q=${encodedQuery}`;
                            break;
                        case 'google':
                            searchUrl = `https://www.google.com/search?q=${encodedQuery}`;
                            break;
                    }

                    if (searchUrl) {
                        window.open(searchUrl, '_blank');
                    }
                }
            },
            watch: {
                config: {
                    handler(newVal, oldVal) {
                        this.saveToLocal();
                    },
                    deep: true
                },
                'config.refreshInterval': {
                    handler(newVal, oldVal) {
                        console.log('refreshInterval å•ç‹¬ç›‘å¬ï¼šä»', oldVal, 'å˜æ›´ä¸º', newVal);
                        this.restartTimer();
                    }
                },
                settings: {
                    handler(newVal) {
                        this.saveToLocal();
                        // å¦‚æœå£çº¸è¢«æ¸…é™¤ï¼Œéšè—ä¸»é¢˜è¦†ç›–å±‚
                        if (!newVal.wallpaperUrl) {
                            this.showThemeOverlay = false;
                        }
                    },
                    deep: true
                }
            },
            mounted() {
                this.loadFromLocal();
                this.restartTimer();
                // å¦‚æœæ²¡æœ‰è®¾ç½®å£çº¸ï¼Œè‡ªåŠ¨åŠ è½½ä¸€ä¸ªéšæœºå£çº¸
                if (!this.settings.wallpaperUrl) {
                    this.loadRandomWallpaper();
                }
                // æ˜¾ç¤ºé¦–æ¬¡è®¿é—®æç¤º
                this.showFirstVisitTip();
            },
            beforeUnmount() {
                if (this.updateTimer) {
                    clearInterval(this.updateTimer);
                }
            }
        }).mount('#app');
    </script>
</body>
</html>